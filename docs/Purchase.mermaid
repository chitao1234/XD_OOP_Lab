graph TD
    A[开始] --> B{检查库存是否足够}
    B -- 库存足够 --> C[将订单加入订单表]
    C --> D[更新库存,添加商品到订单表,删除购物车中的商品]
    D --> E{是否使用优惠券}
    E -- 使用优惠券 --> F[从用户中删除优惠券]
    E -- 未使用优惠券 --> G[计算总价]
    F --> G
    G --> H[返回购买成功]
    B -- 库存不足 --> I[返回库存不足]
    I --> J[结束]